{% include base_path %}

<section class="page__share">
<!--  {% if site.data.ui-text[site.locale].share_on_label %}
    <h4 class="page__share-title">{{ site.data.ui-text[site.locale].share_on_label | default: "Share on" }}</h4>
  {% endif %} -->

  <button onclick="copyUrl(this)" data-url="{{ site.url }}{{ base_path }}{{ page.url }}" class="btn btn--light" title="Copy Link to Clipboard" style="cursor: pointer;"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span> Link &nbsp;</span></button>

  <a href="mailto:?subject={{ page.title | url_encode }}&body=Check out this post from Peter Jacko: {{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--mail" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} Email" style="background-color: #777; border-color: #777;"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i><span> Email</span></a>

  <a href="https://api.whatsapp.com/send?text={{ page.title | url_encode }}%20{{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--success" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} WhatsApp" style="background-color: #25D366; border-color: #25D366;"><i class="fab fa-fw fa-whatsapp" aria-hidden="true"></i><span> WhatsApp</span></a>

  <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--linkedin" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

  <a href="https://bsky.app/intent/compose?text={{ page.title | url_encode }}%20{{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--bluesky" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} Bluesky"><i class="fab fa-fw fa-bluesky" aria-hidden="true"></i><span> Bluesky</span></a>

  <a href="https://x.com/intent/post?text={{ page.title | url_encode }}%20{{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--x" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} X"><i class="fab fa-fw fa-x-twitter" aria-hidden="true"></i><span> X</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u={{ base_path }}{{ page.url | url_encode }}" target="_blank" class="btn btn--facebook" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.addtoany.com/add_to/mastodon?linkurl={{ base_path | append: page.url | url_encode }}" target="_blank" class="btn btn--mastodon" title="{{ site.data.ui-text[site.locale].share_on_label | default: 'Share on' }} Mastodon"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i><span> Mastodon</span></a>
</section>

<script>
function copyUrl(btn) {
  // 1. Get the URL from the data-url attribute
  const urlToCopy = btn.getAttribute('data-url');

  // 2. Attempt to copy
  if (navigator.clipboard && window.isSecureContext) {
    // Modern approach
    navigator.clipboard.writeText(urlToCopy).then(() => {
      showSuccess(btn);
    }).catch(err => {
      fallbackCopy(btn, urlToCopy);
    });
  } else {
    // Fallback approach
    fallbackCopy(btn, urlToCopy);
  }
}

function fallbackCopy(btn, text) {
  const textArea = document.createElement("textarea");
  textArea.value = text;
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();
  try {
    document.execCommand('copy');
    showSuccess(btn);
  } catch (err) {
    console.error('Fallback copy failed', err);
  }
  document.body.removeChild(textArea);
}

function showSuccess(btn) {
  const originalContent = btn.innerHTML;
  btn.innerHTML = '<i class="fas fa-fw fa-check" style="color: #28a745;"></i><span> Copied!</span>';
  setTimeout(() => {
    btn.innerHTML = originalContent;
  }, 2000);
}
</script>
